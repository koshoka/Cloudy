# Cloudy è©³ç´°è¨­è¨ˆæ›¸

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åæ˜ ã—ãŸCloudyã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è©³ç´°è¨­è¨ˆã‚’è¨˜è¿°ã—ã¾ã™ã€‚  
ã€Œ6ç•³ã«è¦³è‘‰æ¤ç‰©ã‚’ç½®ãã€ã‚³ãƒ³ã‚»ãƒ—ãƒˆã®ä¸‹ã€å®Ÿè£…ã«å¿…è¦ãªç”»é¢è¨­è¨ˆã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹é€ ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ç­‰ã‚’å®šç¾©ã—ã¾ã™ã€‚

---

## 1. ç”»é¢è¨­è¨ˆãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¸æŠç”»é¢

#### ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹æˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Ã—] Cloudy - Claude Code GUI                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  Projects                    [Open Project] â”‚
â”‚  Select a project to start working with... â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€ Recent Projects â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                         â”‚ â”‚
â”‚  â”‚  ğŸ“ windsurf-ai        ~/windsurf-ai/  â”‚ â”‚
â”‚  â”‚  ğŸ“ virtual-audio      ~/vad/          â”‚ â”‚
â”‚  â”‚  ğŸ“ local             ~/.claude/local   â”‚ â”‚
â”‚  â”‚                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### UIè¦ç´ è©³ç´°
- **ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ«**: "Cloudy - Claude Code GUI"
- **ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«**: "Projects" + "Open Project"ãƒœã‚¿ãƒ³
- **èª¬æ˜æ–‡**: "Select a project to start working with Claude Code"
- **Recent Projectsã‚«ãƒ¼ãƒ‰**: Claudiaã‚¹ã‚¿ã‚¤ãƒ«ã®è§’ä¸¸ã‚«ãƒ¼ãƒ‰
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé …ç›®**: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ + ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå + ãƒ‘ã‚¹

### 1.2 ã‚»ãƒƒã‚·ãƒ§ãƒ³é¸æŠç”»é¢

#### ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹æˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Ã—] Cloudy - windsurf-ai project            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  windsurf-ai Sessions         [New Session] â”‚
â”‚  Choose session or start new one            â”‚
â”‚                                             â”‚
â”‚  â˜‘ Skip mode (--dangerously-skip...) â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€ Recent Sessions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                         â”‚ â”‚
â”‚  â”‚  ğŸ”„ Session - 2025-08-21 23:47         â”‚ â”‚
â”‚  â”‚  ğŸ“ Session - 2025-08-21 18:32         â”‚ â”‚
â”‚  â”‚  âœ¨ Session - 2025-08-20 15:20         â”‚ â”‚
â”‚  â”‚                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### UIè¦ç´ è©³ç´°
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåè¡¨ç¤º**: ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ« + ãƒ¡ã‚¤ãƒ³è¡¨ç¤º
- **æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹**: çŠ¶æ…‹ä¿æŒã€ãƒˆã‚°ãƒ«å¯èƒ½
- **New Sessionãƒœã‚¿ãƒ³**: æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ
- **Recent Sessionsã‚«ãƒ¼ãƒ‰**: ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´ä¸€è¦§
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³é …ç›®**: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¢ã‚¤ã‚³ãƒ³ + æ—¥æ™‚

### 1.3 å¯¾è©±ç”»é¢ï¼ˆãƒ¡ã‚¤ãƒ³ç”»é¢ï¼‰

#### ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹æˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Ã—] Cloudy - windsurf-ai/cloudy             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€ ä¼šè©±ã‚¨ãƒªã‚¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¤– Welcome! How can I help you today?  â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚ ğŸ‘¤ Please help me create a new...     â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚ ğŸ¤– I'll help you create that. Let me  â”‚ â”‚
â”‚  â”‚    start by...                        â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ > Message Claude (@for files, /for...) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### UIè¦ç´ è©³ç´°
- **ä¼šè©±ã‚¨ãƒªã‚¢**: ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ãªç¸¦é•·ã‚¨ãƒªã‚¢
- **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰**: ğŸ¤–Claudeã€ğŸ‘¤User ã®ã‚¢ã‚¤ã‚³ãƒ³ä»˜ã
  claudeã¨userã®ã‚¢ã‚¤ã‚³ãƒ³ã¯ã‚†ãã‚†ãç‰¹å®šã®ç”»åƒã«ã—ãŸã„ã€‚
- **å…¥åŠ›ã‚¨ãƒªã‚¢**: ç”»é¢ä¸‹éƒ¨å›ºå®šã€Claude Codeå½¢å¼ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
- **ã‚¿ãƒ¼ãƒŸãƒŠãƒ«çµ±åˆ**: å…¥åŠ›ã‚¨ãƒªã‚¢ãŒxterm.jsçµ±åˆ

---

## 2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹é€ è¨­è¨ˆ

### 2.1 Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ„ãƒªãƒ¼

```
App
â”œâ”€â”€ ProjectSelector
â”‚   â”œâ”€â”€ ProjectHeader
â”‚   â”œâ”€â”€ RecentProjectsList
â”‚   â””â”€â”€ ProjectItem
â”‚
â”œâ”€â”€ SessionSelector  
â”‚   â”œâ”€â”€ SessionHeader
â”‚   â”œâ”€â”€ PermissionCheckbox
â”‚   â”œâ”€â”€ RecentSessionsList
â”‚   â””â”€â”€ SessionItem
â”‚
â”œâ”€â”€ ChatInterface
â”‚   â”œâ”€â”€ ConversationArea
â”‚   â”‚   â”œâ”€â”€ MessageCard (Claude)
â”‚   â”‚   â””â”€â”€ MessageCard (User)
â”‚   â”œâ”€â”€ TerminalInput (xterm.jsçµ±åˆ)
â”‚   â””â”€â”€ StatusBar
â”‚
â””â”€â”€ ThemeProvider
    â”œâ”€â”€ MorningTheme (Light/Dark)
    â””â”€â”€ EveningTheme (Light/Dark)
```

### 2.2 ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä»•æ§˜

#### ProjectSelector
```typescript
interface ProjectSelectorProps {
  onProjectSelect: (project: Project) => void;
}

interface Project {
  name: string;
  path: string;
  lastAccessed: Date;
}
```

#### SessionSelector
```typescript
interface SessionSelectorProps {
  project: Project;
  onSessionSelect: (session: Session | 'new') => void;
}

interface Session {
  id: string;
  createdAt: Date;
  lastMessage: string;
  status: 'active' | 'completed' | 'interrupted';
}
```

#### ChatInterface
```typescript
interface ChatInterfaceProps {
  project: Project;
  session: Session;
}

interface Message {
  id: string;
  type: 'user' | 'claude';
  content: string;
  timestamp: Date;
}
```

#### PermissionCheckbox
```typescript
interface PermissionCheckboxProps {
  checked: boolean;
  onChange: (checked: boolean) => void;
  persistent: true; // localStorageè‡ªå‹•ä¿å­˜
}
```

---

## 3. ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆè¨­è¨ˆ

### 3.1 æœãƒ†ãƒ¼ãƒï¼ˆMorning Themeï¼‰

#### æœãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰
```css
:root[data-theme="morning-light"] {
  /* åŸºæœ¬è‰² */
  --bg-primary: linear-gradient(135deg, #E6F3FF 0%, #FFF0F5 100%);
  --bg-secondary: rgba(255, 255, 255, 0.8);
  --text-primary: #2D3748;
  --text-secondary: #4A5568;
  
  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² */
  --accent-primary: #3182CE;    /* æ°´è‰²ç³» */
  --accent-secondary: #E53E3E;  /* æœã®å¤ªé™½è‰² */
  
  /* UIè¦ç´  */
  --border-color: rgba(199, 210, 254, 0.3);
  --card-bg: rgba(255, 255, 255, 0.9);
  --button-bg: #3182CE;
  --button-hover: #2B77C7;
}
```

#### æœãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
```css
:root[data-theme="morning-dark"] {
  /* åŸºæœ¬è‰² */
  --bg-primary: linear-gradient(135deg, #1A202C 0%, #2D3748 100%);
  --bg-secondary: rgba(45, 55, 72, 0.8);
  --text-primary: #F7FAFC;
  --text-secondary: #E2E8F0;
  
  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² */
  --accent-primary: #63B3ED;    /* å„ªã—ã„æ°´è‰² */
  --accent-secondary: #F56565;  /* æ¸©ã‹ã„ãƒ”ãƒ³ã‚¯ */
  
  /* UIè¦ç´  */
  --border-color: rgba(99, 179, 237, 0.2);
  --card-bg: rgba(45, 55, 72, 0.9);
  --button-bg: #63B3ED;
  --button-hover: #4299E1;
}
```

### 3.2 å¤•ãƒ†ãƒ¼ãƒï¼ˆEvening Themeï¼‰

#### å¤•ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰
```css
:root[data-theme="evening-light"] {
  /* åŸºæœ¬è‰² */
  --bg-primary: linear-gradient(135deg, #FDF2F8 0%, #F3E8FF 100%);
  --bg-secondary: rgba(255, 255, 255, 0.8);
  --text-primary: #2D3748;
  --text-secondary: #4A5568;
  
  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² */
  --accent-primary: #8B5CF6;    /* ç´«ç³» */
  --accent-secondary: #EC4899;  /* ãƒ”ãƒ³ã‚¯ç³» */
  
  /* UIè¦ç´  */
  --border-color: rgba(196, 181, 253, 0.3);
  --card-bg: rgba(255, 255, 255, 0.9);
  --button-bg: #8B5CF6;
  --button-hover: #7C3AED;
}
```

#### å¤•ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
```css
:root[data-theme="evening-dark"] {
  /* åŸºæœ¬è‰² */
  --bg-primary: linear-gradient(135deg, #1A1B2E 0%, #16213E 100%);
  --bg-secondary: rgba(26, 27, 46, 0.8);
  --text-primary: #F7FAFC;
  --text-secondary: #E2E8F0;
  
  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè‰² */  
  --accent-primary: #A78BFA;    /* å„ªã—ã„ç´« */
  --accent-secondary: #F472B6;  /* å„ªã—ã„ãƒ”ãƒ³ã‚¯ */
  
  /* UIè¦ç´  */
  --border-color: rgba(167, 139, 250, 0.2);
  --card-bg: rgba(26, 27, 46, 0.9);
  --button-bg: #A78BFA;
  --button-hover: #8B5CF6;
}
```

### 3.3 å’Œç´™é¢¨èƒŒæ™¯ãƒ†ã‚¯ã‚¹ãƒãƒ£

```css
/* å’Œç´™é¢¨ã®ã‚µãƒ–ãƒˆãƒ«ãƒ»ãƒ†ã‚¯ã‚¹ãƒãƒ£ */
.washi-texture {
  background-image: 
    radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 1px, transparent 1px),
    radial-gradient(circle at 80% 50%, rgba(255,255,255,0.1) 1px, transparent 1px);
  background-size: 100px 100px, 120px 120px;
  background-position: 0 0, 30px 30px;
}
```

---

## 4. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

### 4.1 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç† (Zustand)

```typescript
interface AppState {
  // ç¾åœ¨ã®ç”»é¢çŠ¶æ…‹
  currentScreen: 'project-select' | 'session-select' | 'chat';
  
  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–¢é€£
  projects: Project[];
  selectedProject: Project | null;
  
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³é–¢é€£
  sessions: Session[];
  selectedSession: Session | null;
  
  // è¨­å®šé–¢é€£
  settings: {
    skipPermissions: boolean;
    theme: 'morning-light' | 'morning-dark' | 'evening-light' | 'evening-dark';
  };
  
  // ãƒãƒ£ãƒƒãƒˆé–¢é€£
  messages: Message[];
  isClaudeTyping: boolean;
}

interface AppActions {
  // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
  setCurrentScreen: (screen: AppState['currentScreen']) => void;
  
  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ
  loadProjects: () => Promise<void>;
  selectProject: (project: Project) => void;
  
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³æ“ä½œ
  loadSessions: (projectPath: string) => Promise<void>;
  selectSession: (session: Session | 'new') => void;
  
  // è¨­å®šæ“ä½œ
  updateSettings: (settings: Partial<AppState['settings']>) => void;
  
  // ãƒãƒ£ãƒƒãƒˆæ“ä½œ
  sendMessage: (content: string) => Promise<void>;
  addClaudeMessage: (content: string) => void;
}
```

### 4.2 localStorageæ°¸ç¶šåŒ–è¨­è¨ˆ

```typescript
// ä¿å­˜ã•ã‚Œã‚‹è¨­å®šãƒ‡ãƒ¼ã‚¿æ§‹é€ 
interface StoredSettings {
  skipPermissions: boolean;
  theme: string;
  lastProject?: string;
  windowBounds?: {
    x: number;
    y: number; 
    width: number;
    height: number;
  };
}

// LocalStorageã‚­ãƒ¼è¨­è¨ˆ
const STORAGE_KEYS = {
  SETTINGS: 'cloudy-settings',
  PROJECTS: 'cloudy-projects',
  SESSIONS: 'cloudy-sessions-{projectHash}', 
} as const;
```

### 4.3 Claude Code CLIçµ±åˆãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant UI as React UI
    participant Main as Main Process
    participant CLI as Claude Code CLI
    participant Term as xterm.js
    
    UI->>Main: startSession(project, skipPermissions)
    Main->>CLI: spawn('ccode' or 'claude')
    CLI-->>Main: process ready
    Main->>Term: attach(cliProcess)
    Term-->>UI: terminal ready
    
    UI->>Term: user input
    Term->>CLI: stdin
    CLI-->>Term: stdout/stderr
    Term-->>UI: display output
    
    UI->>Main: requestSessionSave()
    Main->>Main: save to localStorage
```

---

## 5. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

### 5.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
cloudy/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/                    # Electron ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹
â”‚   â”‚   â”œâ”€â”€ main.ts             # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ cli-manager.ts      # Claude Code CLIåˆ¶å¾¡
â”‚   â”‚   â”œâ”€â”€ session-manager.ts  # ã‚»ãƒƒã‚·ãƒ§ãƒ³æ°¸ç¶šåŒ–
â”‚   â”‚   â””â”€â”€ settings-manager.ts # è¨­å®šç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ renderer/               # Reactãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹
â”‚   â”‚   â”œâ”€â”€ App.tsx            # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ components/        # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectSelector.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SessionSelector.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MessageCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ TerminalInput.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ThemeProvider.tsx
â”‚   â”‚   â”œâ”€â”€ hooks/             # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ useProjects.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useSessions.ts  
â”‚   â”‚   â”‚   â””â”€â”€ useSettings.ts
â”‚   â”‚   â”œâ”€â”€ stores/            # ZustandçŠ¶æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ app-store.ts
â”‚   â”‚   â”œâ”€â”€ styles/            # CSSãƒ»ãƒ†ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ globals.css
â”‚   â”‚   â”‚   â”œâ”€â”€ themes.css
â”‚   â”‚   â”‚   â””â”€â”€ components.css
â”‚   â”‚   â””â”€â”€ types/             # TypeScriptå‹å®šç¾©
â”‚   â”‚       â”œâ”€â”€ project.ts
â”‚   â”‚       â”œâ”€â”€ session.ts
â”‚   â”‚       â””â”€â”€ message.ts
â”‚   â”‚
â”‚   â””â”€â”€ shared/                # ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼å…±é€š
â”‚       â”œâ”€â”€ ipc-types.ts       # IPCé€šä¿¡å‹å®šç¾©
â”‚       â””â”€â”€ constants.ts       # å…±é€šå®šæ•°
â”‚
â”œâ”€â”€ public/                    # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ package.json
â”œâ”€â”€ electron.vite.config.ts    # Electron + Viteè¨­å®š
â”œâ”€â”€ tsconfig.json
â””â”€â”€ tailwind.config.js         # Tailwind CSSè¨­å®š
```

### 5.2 ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ

#### main/main.ts
```typescript
import { app, BrowserWindow } from 'electron';
import { CLIManager } from './cli-manager';
import { SessionManager } from './session-manager';
import { SettingsManager } from './settings-manager';

class CloudyApp {
  private mainWindow: BrowserWindow | null = null;
  private cliManager: CLIManager;
  private sessionManager: SessionManager;
  private settingsManager: SettingsManager;

  constructor() {
    this.cliManager = new CLIManager();
    this.sessionManager = new SessionManager();
    this.settingsManager = new SettingsManager();
  }

  async init() {
    await app.whenReady();
    this.createMainWindow();
    this.setupIPC();
  }
  
  private createMainWindow() {
    const settings = this.settingsManager.getWindowBounds();
    this.mainWindow = new BrowserWindow({
      width: settings.width || 1200,
      height: settings.height || 800,
      webPreferences: {
        nodeIntegration: false,
        contextIsolation: true,
        preload: path.join(__dirname, 'preload.js'),
      },
    });
  }
  
  private setupIPC() {
    // IPC handlers for CLI, sessions, settings
  }
}

new CloudyApp().init();
```

#### renderer/App.tsx
```typescript
import React from 'react';
import { useAppStore } from './stores/app-store';
import { ProjectSelector } from './components/ProjectSelector';
import { SessionSelector } from './components/SessionSelector';
import { ChatInterface } from './components/ChatInterface';
import { ThemeProvider } from './components/ThemeProvider';

export default function App() {
  const currentScreen = useAppStore(state => state.currentScreen);
  
  const renderScreen = () => {
    switch (currentScreen) {
      case 'project-select':
        return <ProjectSelector />;
      case 'session-select':
        return <SessionSelector />;
      case 'chat':
        return <ChatInterface />;
      default:
        return <ProjectSelector />;
    }
  };
  
  return (
    <ThemeProvider>
      <div className="app-container washi-texture">
        {renderScreen()}
      </div>
    </ThemeProvider>
  );
}
```

---

## 6. xterm.jsçµ±åˆè¨­è¨ˆ

### 6.1 TerminalInput ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
import { Terminal } from 'xterm';
import { FitAddon } from 'xterm-addon-fit';
import * as pty from 'node-pty';

interface TerminalInputProps {
  onCommand: (command: string) => void;
  claudeMessages: Message[];
}

export function TerminalInput({ onCommand, claudeMessages }: TerminalInputProps) {
  const terminalRef = useRef<HTMLDivElement>(null);
  const terminal = useRef<Terminal | null>(null);
  const ptyProcess = useRef<pty.IPty | null>(null);
  
  useEffect(() => {
    if (!terminalRef.current) return;
    
    // xterm.jsåˆæœŸåŒ–
    terminal.current = new Terminal({
      theme: {
        background: 'transparent', // èƒŒæ™¯é€æ˜ã§ãƒ†ãƒ¼ãƒè‰²ã‚’æ´»ç”¨
        foreground: 'var(--text-primary)',
      },
      fontSize: 14,
      fontFamily: 'SF Mono, Monaco, monospace',
    });
    
    // Claude Code CLIãƒ—ãƒ­ã‚»ã‚¹èµ·å‹•
    const settings = getSettings();
    const command = settings.skipPermissions ? 'ccode' : 'claude';
    
    ptyProcess.current = pty.spawn(command, [], {
      name: 'cloudy-terminal',
      cwd: getCurrentProject().path,
    });
    
    // pty â†” xterm æ¥ç¶š
    ptyProcess.current.on('data', (data) => {
      terminal.current?.write(data);
    });
    
    terminal.current.on('data', (data) => {
      ptyProcess.current?.write(data);
    });
    
    // DOMæ¥ç¶š
    terminal.current.open(terminalRef.current);
    
    return () => {
      ptyProcess.current?.kill();
      terminal.current?.dispose();
    };
  }, []);
  
  return (
    <div className="terminal-container">
      <div ref={terminalRef} className="terminal" />
    </div>
  );
}
```

### 6.2 ã‚«ãƒ¼ãƒ‰å‹UIçµ±åˆ

```typescript
// Claudeã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚«ãƒ¼ãƒ‰å‹ã§è¡¨ç¤ºã—ã¤ã¤ã€
// ã‚¿ãƒ¼ãƒŸãƒŠãƒ«å‡ºåŠ›ã‚‚çµ±åˆã™ã‚‹è¨­è¨ˆ

interface MessageCardProps {
  message: Message;
  isTerminalOutput?: boolean;
}

export function MessageCard({ message, isTerminalOutput = false }: MessageCardProps) {
  return (
    <div className={`message-card ${message.type === 'claude' ? 'claude-message' : 'user-message'}`}>
      <div className="message-header">
        {message.type === 'claude' ? 'ğŸ¤–' : 'ğŸ‘¤'}
        <span className="timestamp">{formatTime(message.timestamp)}</span>
      </div>
      <div className="message-content">
        {isTerminalOutput ? (
          <pre className="terminal-output">{message.content}</pre>
        ) : (
          <ReactMarkdown>{message.content}</ReactMarkdown>
        )}
      </div>
    </div>
  );
}
```

---

## 7. å®Ÿè£…å„ªå…ˆé †ä½

### Phase 1: åŸºç›¤æ§‹ç¯‰
1. **Electronãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–** - React + TypeScript + Vite
2. **åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ** - ProjectSelectorç”»é¢
3. **ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ åŸºç›¤** - CSSå¤‰æ•°ãƒ»ThemeProvider
4. **è¨­å®šæ°¸ç¶šåŒ–** - localStorageåŸºæœ¬æ©Ÿèƒ½

### Phase 2: æ ¸å¿ƒæ©Ÿèƒ½
1. **ã‚»ãƒƒã‚·ãƒ§ãƒ³é¸æŠç”»é¢** - æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å«ã‚€
2. **xterm.jsçµ±åˆ** - åŸºæœ¬çš„ãªã‚¿ãƒ¼ãƒŸãƒŠãƒ«è¡¨ç¤º
3. **Claude CLIèµ·å‹•** - ccode/claudeã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
4. **ã‚«ãƒ¼ãƒ‰å‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸UI** - åŸºæœ¬çš„ãªä¼šè©±è¡¨ç¤º

### Phase 3: å®Œæˆåº¦å‘ä¸Š
1. **æœãƒ»å¤•ãƒ†ãƒ¼ãƒå®Ÿè£…** - 4ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å®Œæˆ
2. **UI/UXæœ€é©åŒ–** - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³
3. **ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ** - shift+tabç­‰ã®CLIæ©Ÿèƒ½
4. **ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾©å…ƒ** - `-r`ç›¸å½“æ©Ÿèƒ½

---

## 8. ä»Šå¾Œã®æ‹¡å¼µå¯èƒ½æ€§

### ãƒ†ãƒ¼ãƒã‚«ã‚¹ã‚¿ãƒã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
- èƒŒæ™¯ç”»åƒè¨­å®š
- ãƒ•ã‚©ãƒ³ãƒˆé¸æŠ

### æ©Ÿèƒ½æ‹¡å¼µ
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½
- ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²
- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

---

**ä½œæˆæ—¥**: 2025å¹´08æœˆ21æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è©³ç´°è¨­è¨ˆå®Œäº†ãƒ»å®Ÿè£…æº–å‚™å®Œäº†